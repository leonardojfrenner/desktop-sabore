<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SGR-Desktop - Sistema de Gerenciamento de Restaurantes</title>
    <script>
        // Verificar autentica√ß√£o antes de carregar a p√°gina
        const authenticated = localStorage.getItem('authenticated');
        const restauranteId = localStorage.getItem('restaurante_id');
        
        if (authenticated !== 'true' || !restauranteId) {
            console.log('‚ùå Usu√°rio n√£o autenticado, redirecionando para login...');
            window.location.href = 'paginas/login.html';
        } else {
            console.log('‚úÖ Usu√°rio autenticado, restaurante_id:', restauranteId);
        }
        
        // Fun√ß√£o para verificar autentica√ß√£o periodicamente
        function verificarAutenticacao() {
            const auth = localStorage.getItem('authenticated');
            const id = localStorage.getItem('restaurante_id');
            
            if (auth !== 'true' || !id) {
                console.log('‚ö†Ô∏è Autentica√ß√£o perdida, redirecionando...');
                window.location.href = 'paginas/login.html';
            }
        }
        
        // Verificar autentica√ß√£o a cada 5 segundos
        setInterval(verificarAutenticacao, 5000);
        
        // Verificar ao clicar em qualquer lugar da p√°gina
        document.addEventListener('click', function(event) {
            if (Math.random() < 0.05) { // 5% de chance de verificar
                verificarAutenticacao();
            }
        });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/dashboard.css">
</head>
<body>
    <div class="dashboard-container">
        <!-- Sidebar -->
        <nav class="sidebar">
            <div class="sidebar-header">
                <div id="restauranteLogo" class="restaurante-logo-container">
                    <img id="restauranteImagem" src="" alt="Logo do Restaurante" class="restaurante-logo-img" style="display: none;">
                    <div id="restauranteNome" class="logo">Carregando...</div>
                </div>
            </div>

            <div class="nav-menu">
                <a href="#" class="nav-item active" onclick="loadPage('dashboard')">
                    <span class="nav-icon">üìà</span>
                    Dashboard
                </a>
                <a href="#" class="nav-item" onclick="loadPage('vendas')">
                    <span class="nav-icon">üí∞</span>
                    Gest√£o de Vendas
                </a>
               
                <a href="#" class="nav-item" onclick="loadPage('cardapio')">
                    <span class="nav-icon">üçΩÔ∏è</span>
                    Card√°pio Din√¢mico
                </a>
                <a href="#" class="nav-item" onclick="loadPage('avaliacoes')">
                    <span class="nav-icon">‚≠ê</span>
                    Avalia√ß√µes
                </a>
                <a href="#" class="nav-item" onclick="loadPage('pedidos')">
                    <span class="nav-icon">üõéÔ∏è</span>
                    Gest√£o de Pedidos
                </a>
            </div>
            
            <a href="#" class="logout-link" onclick="logout()">
                <span>üö™</span>
                Sair
            </a>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Status Message -->
            <div id="statusMessage" class="status-message" style="display: none;"></div>

            <!-- Conte√∫do das p√°ginas ser√° carregado aqui -->
            <div id="pageContent">
                <!-- Dashboard ser√° carregado por padr√£o -->
            </div>
        </main>
    </div>

    <script>
        // Fun√ß√£o para carregar CSS dinamicamente
        function loadCSS(href) {
            // Remove CSS existente da p√°gina se houver
            const existingCSS = document.querySelector(`link[href="${href}"]`);
            if (existingCSS) {
                existingCSS.remove();
            }
            
            // Adiciona novo CSS
            const link = document.createElement('link');
            link.rel = 'stylesheet';
            link.href = href;
            document.head.appendChild(link);
        }

        // Navega√ß√£o e carregamento de p√°ginas
        // Fun√ß√£o auxiliar para carregar arquivos HTML (compat√≠vel com file://)
        function loadHTMLFile(url) {
            return new Promise((resolve, reject) => {
                const xhr = new XMLHttpRequest();
                xhr.open('GET', url, true);
                xhr.onreadystatechange = function() {
                    if (xhr.readyState === 4) {
                        if (xhr.status === 200 || xhr.status === 0) { // status 0 para file://
                            resolve(xhr.responseText);
                        } else {
                            reject(new Error(`HTTP ${xhr.status}: ${xhr.statusText}`));
                        }
                    }
                };
                xhr.onerror = function() {
                    reject(new Error('Erro de rede ao carregar arquivo'));
                };
                xhr.send();
            });
        }

        // Fun√ß√£o para executar scripts de HTML carregado dinamicamente (SEQUENCIAL)
        function executeScriptsFromHTML(htmlContent, callback) {
            console.log('üîß Executando scripts do HTML carregado SEQUENCIALMENTE...');
            
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = htmlContent;
            
            const scripts = Array.from(tempDiv.getElementsByTagName('script'));
            let currentIndex = 0;
            let scriptsExecuted = 0;
            
            console.log(`üìã Total de scripts encontrados: ${scripts.length}`);
            
            // Fun√ß√£o recursiva para processar scripts sequencialmente
            function processNextScript() {
                if (currentIndex >= scripts.length) {
                    // Todos os scripts foram processados
                    console.log(`‚úÖ TODOS os ${scriptsExecuted} scripts executados SEQUENCIALMENTE`);
                    if (callback && typeof callback === 'function') {
                        callback(scriptsExecuted);
                    }
                    return;
                }
                
                const originalScript = scripts[currentIndex];
                const newScript = document.createElement('script');
                
                // Copiar todos os atributos do script original
                Array.from(originalScript.attributes).forEach(attr => {
                    newScript.setAttribute(attr.name, attr.value);
                });
                
                if (originalScript.src) {
                    // Script externo - AGUARDAR carregamento antes de continuar
                    console.log(`üìú [${currentIndex + 1}/${scripts.length}] Carregando script externo: ${originalScript.src}`);
                    
                    // üî• CORRE√á√ÉO CR√çTICA: Usar src diretamente (j√° √© relativo correto)
                    const scriptUrl = originalScript.src;
                    console.log(`üîç DEBUG: URL do script: ${scriptUrl}`);
                    
                    newScript.src = scriptUrl;
                    
                    newScript.onload = () => {
                        console.log(`‚úÖ [${currentIndex + 1}/${scripts.length}] Script externo carregado: ${originalScript.src}`);
                        showDebugLog(`Script carregado: ${originalScript.src}`, 'success');
                        scriptsExecuted++;
                        currentIndex++;
                        
                        // üî• CR√çTICO: Aguardar um pouco para garantir execu√ß√£o completa
                        setTimeout(() => {
                            processNextScript(); // Processar pr√≥ximo script
                        }, 50);
                    };
                    
                    newScript.onerror = (error) => {
                        console.error(`‚ùå [${currentIndex + 1}/${scripts.length}] Erro ao carregar script: ${originalScript.src}`, error);
                        showDebugLog(`ERRO ao carregar script: ${originalScript.src}`, 'error');
                        currentIndex++;
                        
                        // Continuar mesmo com erro
                        setTimeout(() => {
                            processNextScript();
                        }, 50);
                    };
                    
                    // Adicionar script ao head para iniciar carregamento
                    document.head.appendChild(newScript);
                    
                } else {
                    // Script inline - executar imediatamente
                    console.log(`üìú [${currentIndex + 1}/${scripts.length}] Executando script inline (${originalScript.textContent.length} caracteres)`);
                    
                    try {
                        newScript.textContent = originalScript.textContent;
                        document.head.appendChild(newScript);
                        
                        console.log(`‚úÖ [${currentIndex + 1}/${scripts.length}] Script inline executado`);
                        scriptsExecuted++;
                        
                    } catch (error) {
                        console.error(`‚ùå [${currentIndex + 1}/${scripts.length}] Erro ao executar script inline:`, error);
                    }
                    
                    currentIndex++;
                    
                    // Continuar imediatamente para o pr√≥ximo script
                    setTimeout(() => {
                        processNextScript();
                    }, 10);
                }
            }
            
            // Iniciar o processamento sequencial
            if (scripts.length > 0) {
                processNextScript();
            } else {
                console.log('‚ö†Ô∏è Nenhum script encontrado no HTML');
                if (callback && typeof callback === 'function') {
                    callback(0);
                }
            }
        }

        async function loadPage(pageName) {
            try {
                // Verificar autentica√ß√£o antes de carregar qualquer p√°gina
                const authenticated = localStorage.getItem('authenticated');
                const restauranteId = localStorage.getItem('restaurante_id');
                
                if (authenticated !== 'true' || !restauranteId) {
                    console.log('‚ö†Ô∏è Usu√°rio n√£o autenticado, redirecionando para login...');
                    window.location.href = 'paginas/login.html';
                    return;
                }
                
                const pageContent = document.getElementById('pageContent');
                
                // Remover classe active de todos os nav-items
                document.querySelectorAll('.nav-item').forEach(item => {
                    item.classList.remove('active');
                });
                
                // Adicionar classe active ao nav-item selecionado
                const clickedItem = document.querySelector(`[onclick="loadPage('${pageName}')"]`);
                if (clickedItem) {
                    clickedItem.classList.add('active');
                }
                
                // üî• CORRE√á√ÉO CR√çTICA: Remover scripts de m√≥dulos para evitar conflitos de redeclara√ß√£o
                const scriptsToRemove = ['dashboard.js', 'vendas.js', 'cardapio.js', 'avaliacoes.js', 'pedidos.js'];
                document.querySelectorAll('script[src]').forEach(script => {
                    const scriptSrc = script.src;
                    // Remover apenas scripts de m√≥dulo espec√≠ficos, preservar bibliotecas essenciais
                    if (scriptsToRemove.some(moduleScript => scriptSrc.includes(moduleScript))) {
                        console.log('üóëÔ∏è Removendo script de m√≥dulo para evitar conflito:', scriptSrc);
                        script.remove();
                    }
                });
                
                switch(pageName) {
                    case 'dashboard':
                        // Carregar CSS do dashboard
                        loadCSS('css/dashboard.css');
                        
                        // Carregar HTML do dashboard
                        console.log('üîÑ Tentando carregar dashboard.html...');
                        const dashboardHTML = await loadHTMLFile('paginas/dashboard.html');
                        console.log('‚úÖ Dashboard HTML carregado com sucesso');
                        pageContent.innerHTML = dashboardHTML;
                        
                        // üî• CORRE√á√ÉO CR√çTICA: Executar scripts do HTML carregado SEQUENCIALMENTE
                        showDebugLog('Iniciando executeScriptsFromHTML para dashboard', 'info');
                        showDebugLog(`HTML cont√©m: ${dashboardHTML.includes('script') ? 'SIM' : 'N√ÉO'} tags script`, 'info');
                        executeScriptsFromHTML(dashboardHTML, (scriptsCount) => {
                            showDebugLog(`Dashboard: ${scriptsCount} scripts executados, iniciando carregamento...`, 'success');
                            
                            // üî• CORRE√á√ÉO: Aguardar mais tempo para garantir que DOM esteja completamente pronto
                            setTimeout(() => {
                                if (typeof inicializarDashboard === 'function') {
                                    showDebugLog('Inicializando Dashboard ap√≥s execu√ß√£o sequencial de scripts', 'success');
                                    inicializarDashboard();
                                } else {
                                    showDebugLog('Fun√ß√£o inicializarDashboard N√ÉO encontrada ap√≥s execu√ß√£o de scripts', 'error');
                                }
                            }, 500);
                        });
                        
                        // üî• SCRIPT PRINCIPAL AGORA VEM DO HTML - N√£o h√° mais carregamento duplicado
                        break;
                        
                    case 'vendas':
                        // Carregar CSS das vendas
                        loadCSS('css/vendas.css');
                        
                        // Carregar HTML das vendas
                        console.log('üîÑ Tentando carregar vendas.html...');
                        const vendasHTML = await loadHTMLFile('paginas/vendas.html');
                        console.log('‚úÖ Vendas HTML carregado com sucesso');
                        pageContent.innerHTML = vendasHTML;
                        
                        // üî• CORRE√á√ÉO CR√çTICA: Executar scripts do HTML carregado SEQUENCIALMENTE
                        executeScriptsFromHTML(vendasHTML, (scriptsCount) => {
                            console.log(`üéØ Vendas: ${scriptsCount} scripts executados, iniciando carregamento...`);
                            
                            setTimeout(() => {
                                if (typeof inicializarVendas === 'function') {
                                    console.log('üéØ Inicializando Vendas ap√≥s execu√ß√£o sequencial de scripts');
                                    inicializarVendas();
                                } else {
                                    console.warn('‚ö†Ô∏è Fun√ß√£o inicializarVendas n√£o encontrada ap√≥s execu√ß√£o de scripts');
                                }
                            }, 200);
                        });
                        
                        // üî• SCRIPT PRINCIPAL AGORA VEM DO HTML - N√£o h√° mais carregamento duplicado
                        break;
                        
                    case 'cardapio':
                        // Carregar CSS do card√°pio
                        loadCSS('css/cardapio.css');
                        
                        // Carregar HTML do card√°pio
                        console.log('üîÑ Tentando carregar cardapio.html...');
                        const cardapioHTML = await loadHTMLFile('paginas/cardapio.html');
                        console.log('‚úÖ Card√°pio HTML carregado com sucesso');
                        pageContent.innerHTML = cardapioHTML;
                        
                        // üî• CORRE√á√ÉO CR√çTICA: Executar scripts do HTML carregado SEQUENCIALMENTE
                        executeScriptsFromHTML(cardapioHTML, (scriptsCount) => {
                            console.log(`üéØ Card√°pio: ${scriptsCount} scripts executados, iniciando carregamento...`);
                            
                            setTimeout(() => {
                                if (typeof inicializarCardapio === 'function') {
                                    console.log('üéØ Inicializando Card√°pio ap√≥s execu√ß√£o sequencial de scripts');
                                    inicializarCardapio();
                                } else {
                                    console.warn('‚ö†Ô∏è Fun√ß√£o inicializarCardapio n√£o encontrada ap√≥s execu√ß√£o de scripts');
                                }
                            }, 200);
                        });
                        
                        // üî• SCRIPT PRINCIPAL AGORA VEM DO HTML - N√£o h√° mais carregamento duplicado
                        break;
                        
                    case 'avaliacoes':
                        // Carregar CSS das avalia√ß√µes
                        loadCSS('css/avaliacoes.css');
                        
                        // Carregar HTML das avalia√ß√µes
                        console.log('üîÑ Tentando carregar avaliacoes.html...');
                        const avaliacoesHTML = await loadHTMLFile('paginas/avaliacoes.html');
                        console.log('‚úÖ Avalia√ß√µes HTML carregado com sucesso');
                        pageContent.innerHTML = avaliacoesHTML;
                        
                        // üî• CORRE√á√ÉO CR√çTICA: Executar scripts do HTML carregado SEQUENCIALMENTE
                        executeScriptsFromHTML(avaliacoesHTML, (scriptsCount) => {
                            console.log(`üéØ Avalia√ß√µes: ${scriptsCount} scripts executados, iniciando carregamento...`);
                            
                            setTimeout(() => {
                                if (typeof inicializarAvaliacoes === 'function') {
                                    console.log('üéØ Inicializando Avalia√ß√µes ap√≥s execu√ß√£o sequencial de scripts');
                                    inicializarAvaliacoes();
                                } else {
                                    console.warn('‚ö†Ô∏è Fun√ß√£o inicializarAvaliacoes n√£o encontrada ap√≥s execu√ß√£o de scripts');
                                }
                            }, 200);
                        });
                        
                        // üî• SCRIPT PRINCIPAL AGORA VEM DO HTML - N√£o h√° mais carregamento duplicado
                        break;
                        
                    case 'pedidos':
                        // Carregar CSS dos pedidos
                        loadCSS('css/pedidos.css');
                        
                        // Carregar HTML dos pedidos
                        console.log('üîÑ Tentando carregar pedidos.html...');
                        const pedidosHTML = await loadHTMLFile('paginas/pedidos.html');
                        console.log('‚úÖ Pedidos HTML carregado com sucesso');
                        pageContent.innerHTML = pedidosHTML;
                        
                        // üî• CORRE√á√ÉO CR√çTICA: Executar scripts do HTML carregado SEQUENCIALMENTE
                        executeScriptsFromHTML(pedidosHTML, (scriptsCount) => {
                            console.log(`üéØ Pedidos: ${scriptsCount} scripts executados, iniciando carregamento...`);
                            
                            // üî• CORRE√á√ÉO: Aguardar scripts carregarem e inicializar
                            setTimeout(() => {
                                if (typeof PedidosApp !== 'undefined' && typeof PedidosApp.init === 'function') {
                                    console.log('üéØ Inicializando Pedidos ap√≥s execu√ß√£o sequencial de scripts');
                                    // Verificar se j√° foi inicializado
                                    if (!PedidosApp.config.restaurante_id) {
                                        PedidosApp.init();
                                    }
                                }
                            }, 100);
                        });
                        
                        break;
                        
                    case 'estoque':
                        pageContent.innerHTML = `
                            <div class="page-header">
                                <h1>Controle de Estoque</h1>
                                <p>Gerencie o estoque dos seus produtos</p>
                            </div>
                            <div class="content-placeholder">
                                <p>üöß P√°gina em desenvolvimento</p>
                            </div>
                        `;
                        break;
                        
                    default:
                        pageContent.innerHTML = `
                            <div class="page-header">
                                <h1>P√°gina n√£o encontrada</h1>
                                <p>A p√°gina solicitada n√£o existe</p>
                            </div>
                        `;
                }
                
            } catch (error) {
                console.error('‚ùå Erro ao carregar p√°gina:', error);
                console.error('‚ùå Detalhes do erro:', {
                    message: error.message,
                    stack: error.stack,
                    pageName: pageName,
                    currentURL: window.location.href,
                    baseURL: window.location.origin
                });
                
                document.getElementById('pageContent').innerHTML = `
                    <div class="flex items-center justify-center h-full">
                        <div class="text-center max-w-md bg-white p-8 rounded-lg shadow-lg">
                            <h2 class="text-2xl font-bold text-red-600 mb-4">Erro ao carregar p√°gina</h2>
                            <p class="text-gray-600 mb-4">${error.message}</p>
                            <div class="bg-gray-100 p-4 rounded-lg text-left text-sm mb-4">
                                <p><strong>P√°gina:</strong> ${pageName}</p>
                                <p><strong>URL Base:</strong> ${window.location.origin}</p>
                                <p><strong>Caminho Tentado:</strong> paginas/${pageName}.html</p>
                            </div>
                            <button onclick="location.reload()" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">
                                Recarregar P√°gina
                            </button>
                        </div>
                    </div>
                `;
            }
        }

        // Fun√ß√£o de logout
        function logout() {
            if (confirm('Tem certeza que deseja sair?')) {
                // Limpar localStorage
                localStorage.removeItem('authenticated');
                localStorage.removeItem('restaurante_id');
                localStorage.removeItem('restaurante_nome');
                
                console.log('üö™ Logout realizado, redirecionando para login...');
                
                // Redirecionar para login
                window.location.href = 'paginas/login.html';
            }
        }

        // Delega√ß√£o de eventos para bot√µes din√¢micos
        document.body.addEventListener('click', function(event) {
            // Bot√µes de navega√ß√£o din√¢micos
            if (event.target.matches('[data-page]')) {
                event.preventDefault();
                const pageName = event.target.getAttribute('data-page');
                console.log(`üîÑ Navega√ß√£o via delega√ß√£o para: ${pageName}`);
                loadPage(pageName);
                return;
            }
            
            // Bot√µes de a√ß√£o din√¢micos (CRUD, etc.)
            if (event.target.matches('.btn-action')) {
                event.preventDefault();
                const action = event.target.getAttribute('data-action');
                const target = event.target.getAttribute('data-target');
                console.log(`üéØ A√ß√£o via delega√ß√£o: ${action} em ${target}`);
                
                // Aqui voc√™ pode chamar fun√ß√µes espec√≠ficas baseadas na a√ß√£o
                if (typeof window[action] === 'function') {
                    window[action](target);
                }
                return;
            }
            
            // Bot√µes de formul√°rio din√¢micos
            if (event.target.matches('.btn-form')) {
                event.preventDefault();
                const formAction = event.target.getAttribute('data-form-action');
                console.log(`üìù A√ß√£o de formul√°rio via delega√ß√£o: ${formAction}`);
                return;
            }
        });

        // Fun√ß√£o de debug desabilitada para produ√ß√£o
        function showDebugLog(message, type = 'info') {
            // Debug logs desabilitados - apenas console para desenvolvimento
            console.log(`[${new Date().toLocaleTimeString()}] ${message}`);
        }

        // Definir API_BASE_URL se n√£o estiver definido
        window.API_BASE_URL = window.API_BASE_URL || 'http://localhost:5000/api';
        
        // Fun√ß√£o para carregar informa√ß√µes do restaurante
        async function carregarInfoRestaurante() {
            try {
                const restauranteId = localStorage.getItem('restaurante_id');
                if (!restauranteId) {
                    console.warn('‚ö†Ô∏è ID do restaurante n√£o encontrado');
                    const nomeElement = document.getElementById('restauranteNome');
                    if (nomeElement) {
                        nomeElement.textContent = localStorage.getItem('restaurante_nome') || 'Restaurante';
                    }
                    return;
                }
                
                // Tentar buscar pelo endpoint de perfil primeiro
                let response = await fetch(`${window.API_BASE_URL}/restaurantes/perfil`, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
                
                if (!response.ok) {
                    // Se perfil n√£o funcionar, buscar por ID
                    console.log('‚ö†Ô∏è Perfil n√£o dispon√≠vel, buscando por ID...');
                    response = await fetch(`${window.API_BASE_URL}/restaurantes/${restauranteId}`, {
                        method: 'GET',
                        headers: {
                            'Content-Type': 'application/json'
                        }
                    });
                }
                
                if (response.ok) {
                    const data = await response.json();
                    
                    // Extrair nome e imagem do restaurante
                    let nomeRestaurante = null;
                    let imagemRestaurante = null;
                    
                    // Tentar diferentes formatos de resposta
                    if (data.data) {
                        nomeRestaurante = data.data.nome || data.data.restaurante_nome;
                        imagemRestaurante = data.data.imagemUrl || data.data.imagem_url || data.data.logoUrl || data.data.logo_url || data.data.fotoUrl || data.data.foto_url;
                    } else if (data.nome) {
                        nomeRestaurante = data.nome;
                        imagemRestaurante = data.imagemUrl || data.imagem_url || data.logoUrl || data.logo_url || data.fotoUrl || data.foto_url;
                    }
                    
                    // Se n√£o encontrou, usar do localStorage
                    if (!nomeRestaurante) {
                        nomeRestaurante = localStorage.getItem('restaurante_nome') || 'Restaurante';
                    }
                    
                    // Atualizar nome
                    const nomeElement = document.getElementById('restauranteNome');
                    if (nomeElement) {
                        nomeElement.textContent = nomeRestaurante || 'Restaurante';
                    }
                    
                    // Atualizar imagem se houver
                    const imagemElement = document.getElementById('restauranteImagem');
                    if (imagemRestaurante && imagemElement) {
                        imagemElement.src = imagemRestaurante;
                        imagemElement.style.display = 'block';
                        imagemElement.onerror = function() {
                            // Se a imagem falhar ao carregar, esconder
                            console.warn('‚ö†Ô∏è Erro ao carregar imagem do restaurante:', imagemRestaurante);
                            this.style.display = 'none';
                        };
                        imagemElement.onload = function() {
                            console.log('‚úÖ Imagem do restaurante carregada com sucesso');
                        };
                    } else if (imagemElement) {
                        // Tentar usar imagem salva no localStorage
                        const imagemSalva = localStorage.getItem('restaurante_imagem');
                        if (imagemSalva) {
                            imagemElement.src = imagemSalva;
                            imagemElement.style.display = 'block';
                        } else {
                            imagemElement.style.display = 'none';
                        }
                    }
                    
                    // Salvar no localStorage para uso futuro
                    if (nomeRestaurante) {
                        localStorage.setItem('restaurante_nome', nomeRestaurante);
                    }
                    if (imagemRestaurante) {
                        localStorage.setItem('restaurante_imagem', imagemRestaurante);
                    }
                    
                    console.log('‚úÖ Informa√ß√µes do restaurante carregadas:', { nome: nomeRestaurante, imagem: imagemRestaurante });
                } else {
                    // Usar dados do localStorage como fallback
                    const nomeSalvo = localStorage.getItem('restaurante_nome');
                    const imagemSalva = localStorage.getItem('restaurante_imagem');
                    
                    const nomeElement = document.getElementById('restauranteNome');
                    if (nomeSalvo && nomeElement) {
                        nomeElement.textContent = nomeSalvo;
                    } else if (nomeElement) {
                        nomeElement.textContent = 'Restaurante';
                    }
                    
                    const imagemElement = document.getElementById('restauranteImagem');
                    if (imagemSalva && imagemElement) {
                        imagemElement.src = imagemSalva;
                        imagemElement.style.display = 'block';
                    } else if (imagemElement) {
                        imagemElement.style.display = 'none';
                    }
                }
            } catch (error) {
                console.error('‚ùå Erro ao carregar informa√ß√µes do restaurante:', error);
                // Usar dados do localStorage como fallback
                const nomeSalvo = localStorage.getItem('restaurante_nome');
                const imagemSalva = localStorage.getItem('restaurante_imagem');
                
                const nomeElement = document.getElementById('restauranteNome');
                if (nomeSalvo && nomeElement) {
                    nomeElement.textContent = nomeSalvo;
                } else if (nomeElement) {
                    nomeElement.textContent = 'Restaurante';
                }
                
                const imagemElement = document.getElementById('restauranteImagem');
                if (imagemSalva && imagemElement) {
                    imagemElement.src = imagemSalva;
                    imagemElement.style.display = 'block';
                } else if (imagemElement) {
                    imagemElement.style.display = 'none';
                }
            }
        }
        
        // Carregar dashboard por padr√£o quando a p√°gina carregar
        document.addEventListener('DOMContentLoaded', () => {
            showDebugLog('P√°gina principal carregada, carregando dashboard...', 'info');
            
            // Carregar informa√ß√µes do restaurante
            carregarInfoRestaurante();
            
            // Carregar dashboard
            loadPage('dashboard');
        });
    </script>
</body>
</html>
